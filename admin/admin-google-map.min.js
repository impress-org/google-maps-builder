var gmb_data;!function($,gmb){"use strict";gmb.init=function(){gmb.toggle_metabox_fields(),gmb.initialize_tooltips(),gmb.initialize_map($("#map")),$("#gmb_lat_lng-latitude").on("change",function(){gmb.lat_lng_field_change(map)}),$("#gmb_lat_lng-longitude").on("change",function(){gmb.lat_lng_field_change(map)}),$(".drop-marker").on("click",function(e){if(e.preventDefault(),$(this).hasClass("active"))$(this).html(gmb_data.i18n.btn_drop_marker).removeClass("active"),map.setOptions({draggableCursor:null});else{$(this).text(gmb_data.i18n.btn_drop_marker_click).addClass("active"),map.setOptions({draggableCursor:"crosshair"});var a=google.maps.event.addListener(map,"click",function(e){gmb.drop_marker(e.latLng,a)})}});var e;$("#gmb_search_radius").on("focus",function(){google.maps.event.trigger(map,"resize"),e=$(this).val(),gmb.calc_radius(map,parseInt($(this).val()))}).focusout(function(){e!==$(this).val()&&gmb.perform_places_search(),radius_circle.setMap(null),radius_marker.setMap(null)}),$('[name^="gmb_places_search_multicheckbox"]').on("change",function(){0===$(".places-change-message").length&&($(".cmb2-id-gmb-places-search-multicheckbox ul").prepend('<div class="wpgp-message places-change-message clear"><p>'+gmb_data.i18n.places_selection_changed+'</p><a href="#" class="button update-places-map">'+gmb_data.i18n.set_place_types+"</a></div>"),$(".places-change-message").slideDown())}),$(".cmb-multicheck-toggle").on("click",function(){0===$(".places-change-message").length&&($(".cmb2-id-gmb-places-search-multicheckbox ul").prepend('<div class="wpgp-message places-change-message clear"><p>'+gmb_data.i18n.places_selection_changed+'</p><a href="#" class="button update-places-map">'+gmb_data.i18n.set_place_types+"</a></div>"),$(".places-change-message").slideDown())}),$(document).on("click",".update-places-map",function(e){e.preventDefault(),gmb.scroll_to_field("#google_maps_preview_metabox"),gmb.perform_places_search(),$(this).parent().fadeOut(function(){$(this).remove()})}),$(".lat-lng-update-btn, .update-lat-lng").on("click",function(e){e.preventDefault(),$(this).attr("disabled","disabled"),$(".lat-lng-change-message").slideUp(),$("#gmb_lat_lng-latitude").val($(this).attr("data-lat")),$("#gmb_lat_lng-longitude").val($(this).attr("data-lng"))}),$(document).on("click",".add-marker",function(e){e.preventDefault(),hover_circle.setVisible(!1);var a=new google.maps.Marker({position:tentative_location_marker.getPosition(),map:map,icon:gmb_data.default_marker,zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1});tentative_location_marker.setVisible(!1);var t=gmb.get_marker_index(),o=$(this).data("place_id");gmb.get_editable_info_window(t,a),$('input[data-field="#gmb_markers_group_'+t+'_title"]').val($(this).data("title")),$("input#gmb_markers_group_"+t+"_lat").val($(this).data("lat")),$("input#gmb_markers_group_"+t+"_lng").val($(this).data("lng")),$("input#gmb_markers_group_"+t+"_place_id").val(o),google.maps.event.addListener(a,"click",function(){gmb.get_info_window_content(t,a)})}),gmb.set_map_marker_icon(),$("#gmb_type").change(function(){gmb.set_map_type(!0)}),$("#gmb_theme").change(function(){gmb.set_map_theme()}),$("#gmb_street_view").change(function(){gmb.set_street_view()}),$("#gmb_pan").change(function(){gmb.set_pan_control()}),$("#gmb_draggable").change(function(){gmb.set_draggable()}),$("#gmb_double_click").change(function(){gmb.set_double_click_zoom()}),$("#gmb_wheel_zoom").change(function(){gmb.set_mouse_wheel_scroll()}),$("#gmb_map_type_control").change(function(){gmb.set_map_type_control()}),$("#gmb_zoom_control").change(function(){gmb.set_map_zoom_control()}),$("#gmb_marker_animate1").change(function(){gmb.clear_main_markers()}),$(".cmb-repeatable-grouping").addClass("closed"),$(".toggle-repeater-groups").on("click",function(e){e.preventDefault(),$("#gmb_markers_group_repeat").find(".cmb-repeatable-grouping").toggleClass("closed")}),$(window).on("resize",function(){google.maps.event.trigger(map,"resize")})};var map,places_service,lat_lng,zoom,lat_field,lng_field,radius_circle,radius_marker,place,autocomplete,info_bubble,info_bubble_array=[],tentative_location_marker,location_marker,location_marker_array=[],search_markers=[],hover_circle,initial_location,delay=function(){var e=0;return function(a,t){clearTimeout(e),e=setTimeout(a,t)}}();gmb.drop_marker=function(e,a){var t=e.lat(),o=e.lng();"undefined"!=typeof i&&i.setVisible(!1),$(".drop-marker").removeClass("active").html(gmb_data.i18n.btn_drop_marker),map.setOptions({draggableCursor:null}),google.maps.event.removeListener(a);var i=new Marker({position:e,map:map,icon:gmb_data.default_marker,zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1}),n=gmb.get_marker_index();$("#gmb_markers_group_"+n+"_title").val("Point "+parseInt(n+1)),$("#gmb_markers_group_"+n+"_lat").val(t),$("#gmb_markers_group_"+n+"_lng").val(o),gmb.get_editable_info_window(n,i),google.maps.event.addListener(i,"click",function(){gmb.get_info_window_content(n,i)})},gmb.initialize_map=function(e){lat_field=$("#gmb_lat_lng-latitude"),lng_field=$("#gmb_lat_lng-longitude");var a=$(".live-latitude"),t=$(".live-longitude"),o=lat_field.val()?lat_field.val():"",i=lng_field.val()?lng_field.val():"";zoom=parseInt($("#gmb_zoom").val()),lat_lng=new google.maps.LatLng(o,i);var n={zoom:zoom,streetViewControl:!1,styles:[{stylers:[{visibility:"simplified"}]},{elementType:"labels",stylers:[{visibility:"off"}]}]};if(map=new google.maps.Map(e[0],n),window.map=map,places_service=new google.maps.places.PlacesService(map),navigator.geolocation&&"yes"===gmb_data.geolocate_setting&&""==i&&""==o&&"https:"===location.protocol?navigator.geolocation.getCurrentPosition(function(e){initial_location=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),map.setCenter(initial_location),lat_field.val(e.coords.latitude),lng_field.val(e.coords.longitude),a.text(e.coords.latitude),t.text(e.coords.longitude)}):""!==o&&""!==i?map.setCenter(new google.maps.LatLng(o,i)):(initial_location=new google.maps.LatLng(gmb_data.default_lat,gmb_data.default_lng),lat_field.val(gmb_data.default_lat),lng_field.val(gmb_data.default_lng),a.text(gmb_data.default_lat),t.text(gmb_data.default_lng),map.setCenter(initial_location)),gmb.set_map_type(!1),gmb.set_map_theme(),gmb.set_street_view(),gmb.set_pan_control(),gmb.set_draggable(),gmb.set_double_click_zoom(),gmb.set_mouse_wheel_scroll(),gmb.set_map_type_control(),gmb.set_map_zoom_control(),"undefined"==typeof autocomplete){var r=$("#gmb_geocoder");autocomplete=new google.maps.places.Autocomplete(r[0]),autocomplete.bindTo("bounds",map),google.maps.event.addDomListener(r[0],"keydown",function(e){13==e.keyCode&&e.preventDefault()}),google.maps.event.addListener(autocomplete,"place_changed",function(){return r.one("blur",function(){r.val("")}),setTimeout(function(){r.val("")},10),"undefined"!=typeof tentative_location_marker&&tentative_location_marker.setVisible(!1),$(".cmb2-id-gmb-geocoder").find(".gmb-modal-close").trigger("click"),$(".cmb2-id-gmb-geocoder").find(".mfp-close").trigger("click"),place=autocomplete.getPlace(),lat_field.val(place.geometry.location.lat()),lng_field.val(place.geometry.location.lng()),place.geometry?(map.setCenter(place.geometry.location),void gmb.add_tentative_marker(map,place.place_id)):void alert("Error: Place not found!")})}info_bubble=new google.maps.InfoWindow({maxWidth:315}),google.maps.event.addListenerOnce(map,"idle",function(){gmb.handle_map_zoom(map),gmb.add_markers(map),"undefined"!=typeof $(".cmb2-id-gmb-show-places input:radio").prop("checked")&&"yes"===$(".cmb2-id-gmb-show-places input:radio:checked").val()&&gmb.perform_places_search()}),google.maps.event.addListener(map,"zoom_changed",function(){gmb.handle_map_zoom(map)}),google.maps.event.addListener(map,"dragend",function(){var e=map.getCenter();$(".lat-lng-change-message").slideDown(),$(".lat-lng-update-btn").attr("data-lat",e.lat()),$(".lat-lng-update-btn").attr("data-lng",e.lng())})},gmb.add_tentative_marker=function(e,a){var t=e.getCenter();tentative_location_marker=new google.maps.Marker({map:e,title:"Map Icons",animation:google.maps.Animation.DROP,position:new google.maps.LatLng(t.lat(),t.lng()),icon:new google.maps.MarkerImage(gmb_data.plugin_url+"assets/img/default-icon-green-no-dot.png"),zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1});var o=google.maps.event.addListener(tentative_location_marker,"mouseover",function(e){gmb.add_circle(a)}),i=google.maps.event.addListener(tentative_location_marker,"mouseout",function(e){hover_circle.setVisible(!1)});google.maps.event.addListener(tentative_location_marker,"click",function(){google.maps.event.removeListener(o),google.maps.event.removeListener(i),hover_circle.setVisible(!0),gmb.add_tenative_info_window(a,tentative_location_marker)}),tentative_location_marker.setVisible(!0),e.setZoom(zoom)},gmb.add_tenative_info_window=function(e,a){var t={key:gmb_data.api_key,placeId:e};places_service.getDetails(t,function(e,t){if(t==google.maps.places.PlacesServiceStatus.OK){var o=e.geometry.location.lat(),i=e.geometry.location.lng(),n='<p class="place-title">'+e.name+"</p>";n+=gmb.add_place_content_to_info_window(e),n+='<div class="infowindow-toolbar clear"><a href="#" class="add-marker" data-title="'+e.name+'" data-place_id="'+e.place_id+'"  data-lat="'+o+'" data-lng="'+i+'">Add to Map</a></div>',n=gmb.set_info_window_wrapper(n),info_bubble.setContent(n),info_bubble.open(map,a),google.maps.event.addListener(info_bubble,"closeclick",function(){hover_circle.setVisible(!1)})}})},gmb.add_place_content_to_info_window=function(e){var a;return a='<div class="marker-info-wrapper">',a+=e.formatted_address?'<div class="place-address">'+e.formatted_address+"</div>":"",a+=e.formatted_phone_number?'<div class="place-phone">'+e.formatted_phone_number+"</div>":"",a+=e.website?'<div class="place-website"><a href="'+e.website+'" target="_blank" rel="nofollow" title="Click to visit the '+e.name+' website">'+gmb_data.i18n.visit_website+"</a></div>":"",e.rating&&(a+='<div class="rating-wrap clear"><p class="numeric-rating">'+e.rating+'</p><div class="star-rating-wrap"><div class="star-rating-size" style="width:'+65*e.rating/5+'px;"></div></div></div>'),e.formatted_address&&(a+='<a href="https://www.google.com/maps/dir/Current+Location/'+encodeURIComponent(e.formatted_address)+'" target="_blank" title="'+gmb_data.i18n.get_directions+'">'+gmb_data.i18n.get_directions+"</a>"),a+="</div>"},gmb.get_editable_info_window=function(index,marker){info_bubble.close(),info_bubble.setContent('<div id="infobubble-content" class="loading"></div>'),info_bubble.open(map,marker);var info_window_data=gmb.get_info_window_saved_data(index),info_window_content;info_window_data.title||(info_window_data.title="Point "+index),info_window_data.title&&(info_window_content='<input class="edit-place-title" data-field="#gmb_markers_group_'+index+'_title" type="text" value="'+info_window_data.title+'">'),info_window_content+=info_window_data.desc?'<textarea class="edit-place-description" data-field="#gmb_markers_group_'+index+'_description">'+info_window_data.desc+"</textarea>":'<textarea class="edit-place-description" data-field="#gmb_markers_group_'+index+'_description"></textarea>',info_window_content+='<div class="infowindow-toolbar clear"><ul id="save-toolbar"><li class="info-window-save"><div class="google-btn-blue google-btn google-save-btn" data-tooltip="Save changes" data-index="'+index+'">Save</div></li><li class="info-window-cancel"><div class="google-btn-default google-btn google-cancel-btn" data-tooltip="Cancel edit" data-index="'+index+'">Cancel</div></li></ul><span class="marker-edit-link-wrap" data-index="'+index+'"><a href="#" data-target="marker-icon-modal" data-tooltip="Change icon" data-mfp-src="#marker-icon-modal" class="marker-edit-link gmb-magnific-marker gmb-magnific-inline"></a></span></div>',info_window_content=gmb.set_info_window_wrapper(info_window_content),info_bubble.setContent(info_window_content),gmb.initialize_tooltips(),google.maps.event.addDomListener($(".google-save-btn")[0],"click",function(){var e=$(".edit-place-title").data("field"),a=$(".edit-place-title").val(),t=$(".edit-place-description").data("field"),o=$(".edit-place-description").val();$(e).val(a),$(t).val(o),gmb.get_info_window_content($(this).data("index"),marker),google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)}),$("#gmb_markers_group_"+index+"_title").parents(".cmb-repeatable-grouping").find(".cmb-remove-group-row").each(function(){google.maps.event.addDomListener($(this)[0],"click",function(){$(this).parents(".cmb-repeatable-grouping").data("index");info_bubble.close(),marker.setVisible(!1)})}),google.maps.event.addDomListener(info_bubble,"closeclick",function(){google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)}),google.maps.event.addDomListener($(".google-cancel-btn")[0],"click",function(){gmb.get_info_window_content($(this).data("index"),marker),google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)});var edit_marker_icon_button_click=google.maps.event.addDomListener($(".marker-edit-link-wrap")[0],"click",function(){$(".save-marker-button").attr("data-marker-index",$(this).data("index"))}),save_icon_listener=google.maps.event.addDomListener($(".save-marker-button")[0],"click",function(e){e.preventDefault();var marker_position=marker.getPosition(),marker_icon=$(this).data("marker"),marker_icon_color=$(this).data("marker-color"),label_color=$(this).data("label-color"),marker_icon_data,marker_label_inline_style="color:"+label_color+"; ";"MAP_PIN"===marker_icon?marker_label_inline_style+="font-size: 20px;position: relative; top: -3px;":"SQUARE_PIN"==marker_icon&&(marker_label_inline_style+="font-size: 20px;position: relative; top: 12px;");var marker_label_data='<i class="'+$(this).data("label")+'" style="'+marker_label_inline_style+'"></i>';"mapicons"==marker_icon||"upload"==marker_icon||"default"==marker_icon?(marker_icon_data=$(this).data("marker-image"),marker_label_data="",$("#gmb_markers_group_"+index+"_marker_img").val(marker_icon_data),$("#gmb_markers_group_"+index+"_marker","#gmb_markers_group_"+index+"_label").val("")):"MAP_PIN"!=marker_icon&&"SQUARE_PIN"!=marker_icon||(marker_icon_data="{ path : "+marker_icon+', fillColor : "'+marker_icon_color+'", fillOpacity : 1, strokeColor : "", strokeWeight: 0, scale : 1 / 3 }',$("#gmb_markers_group_"+index+"_marker").val(marker_icon_data),$("#gmb_markers_group_"+index+"_label").val(marker_label_data),marker_icon_data=eval("("+marker_icon_data+")"),$("#gmb_markers_group_"+index+"_marker_img").val("")),marker.setMap(null);var marker_args={position:marker_position,map:map,zIndex:9,icon:marker_icon_data,custom_label:marker_label_data};marker=new Marker(marker_args),google.maps.event.addListener(marker,"click",function(){gmb.get_info_window_content(index,marker)}),$(".icon, .marker-item").removeClass("marker-item-selected"),$(".marker-icon-row, .save-marker-icon").hide(),$(this).removeData("marker"),$(this).removeData("marker-color"),$(this).removeData("marker-img"),$(this).removeData("label"),$(this).removeData("label-color"),0===$(".magnific-builder").length?$.magnificPopup.close():$(".gmb-modal-close").trigger("click"),google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)})},gmb.set_info_window_wrapper=function(e){var a='<div id="infobubble-content" class="main-place-infobubble-content">';return a+=e,a+="</div>"},gmb.add_circle=function(e){hover_circle=new google.maps.Marker({position:tentative_location_marker.getPosition(),zIndex:google.maps.Marker.MAX_ZINDEX-1,optimized:!1,icon:{path:google.maps.SymbolPath.CIRCLE,scale:20,strokeWeight:3,strokeOpacity:.9,strokeColor:"#FFF",fillOpacity:.3,fillColor:"#FFF"},map:map}),google.maps.event.addListener(hover_circle,"click",function(){gmb.add_tenative_info_window(e,tentative_location_marker)}),google.maps.event.addListener(tentative_location_marker,"click",function(){hover_circle.setVisible(!0)})},gmb.add_markers=function(map){gmb.clear_main_markers();var time=500,markers=[],cluster_markers=$("#gmb_marker_cluster1").prop("checked");if($("#gmb_markers_group_repeat").find(".cmb-repeatable-grouping").each(function(index){var marker_icon=gmb_data.default_marker,marker_label="",custom_marker_icon=$("#gmb_markers_group_"+index+"_marker").val(),custom_marker_img=$("#gmb_markers_group_"+index+"_marker_img").val();if(custom_marker_img)marker_icon=custom_marker_img;else if(custom_marker_icon.length>0&&custom_marker_icon.length>0){var custom_label=$("#gmb_markers_group_"+index+"_label").val();marker_icon=eval("("+custom_marker_icon+")"),marker_label=custom_label}var marker_lat=parseFloat($("#gmb_markers_group_"+index+"_lat").val()),marker_lng=parseFloat($("#gmb_markers_group_"+index+"_lng").val()),place_id=$("#gmb_markers_group_"+index+"_place_id").val(),position=new google.maps.LatLng(marker_lat,marker_lng),marker_args={position:position,map:map,zIndex:index,icon:marker_icon,custom_label:marker_label};place_id&&"enabled"===gmb_data.signed_in_option&&(delete marker_args.position,marker_args.place={location:{lat:marker_lat,lng:marker_lng},placeId:place_id},marker_args.attribution={source:gmb_data.site_name,webUrl:gmb_data.site_url});var location_marker=new Marker(marker_args);markers.push(location_marker),location_marker.setVisible(!0),google.maps.event.addListener(location_marker,"click",function(){gmb.get_info_window_content(index,location_marker)}),time+=500,$("#gmb_markers_group_"+index+"_title").parents(".cmb-repeatable-grouping").find(".cmb-remove-group-row").each(function(){google.maps.event.addDomListener($(this)[0],"click",function(){$(this).parents(".cmb-repeatable-grouping").data("index");info_bubble.close(),location_marker.setVisible(!1)})})}),cluster_markers===!0)var markerCluster=new MarkerClusterer(map,markers)},gmb.get_info_window_saved_data=function(e){var a={};return a.title=$("#gmb_markers_group_"+e+"_title").val(),a.desc=$("#gmb_markers_group_"+e+"_description").val(),a.reference=$("#gmb_markers_group_"+e+"_reference").val(),a.place_id=$("#gmb_markers_group_"+e+"_place_id").val(),a.lat=$("#gmb_markers_group_"+e+"_lat").val(),a.lng=$("#gmb_markers_group_"+e+"_lng").val(),a.hide_place_info=$("#gmb_markers_group_"+e+"_hide_details").prop("checked"),a},gmb.get_info_window_content=function(e,a){info_bubble.close(),info_bubble.setContent('<div id="infobubble-content" class="loading"></div>'),info_bubble.open(map,a);var t=gmb.get_info_window_saved_data(e),o='<p class="place-title">'+t.title+"</p>";if(o+='<div class="place-description">'+t.desc+"</div>",t.place_id&&t.hide_place_info===!1){var i={key:gmb_data.api_key,placeId:t.place_id};places_service.getDetails(i,function(t,i){i==google.maps.places.PlacesServiceStatus.OK&&(o+=gmb.add_place_content_to_info_window(t),o+=gmb.set_marker_edit_icons(e),gmb.add_edit_events(o,a))})}else o+=gmb.set_marker_edit_icons(e),gmb.add_edit_events(o,a)},gmb.add_edit_events=function(e,a){e=gmb.set_info_window_wrapper(e),info_bubble.setContent(e),gmb.initialize_tooltips(),google.maps.event.addDomListener($(".edit-info")[0],"click",function(){gmb.get_editable_info_window($(this).data("index"),a)}),google.maps.event.addDomListener($(".trash-marker")[0],"click",function(){var e=$(this).data("index");$('div[data-iterator="'+e+'"] ').find("input,textarea").val(""),$('div[data-iterator="'+e+'"]').find(".cmb-remove-group-row").trigger("click"),info_bubble.close(),a.setVisible(!1)})},gmb.get_marker_index=function(){},gmb.get_place_info_window_content=function(e,a){info_bubble.setContent('<div id="infobubble-content" class="loading"></div>'),info_bubble.open(map,a);var t={key:gmb_data.api_key,placeId:e.place_id};places_service.getDetails(t,function(e,a){if(a==google.maps.places.PlacesServiceStatus.OK){var t;t='<p class="place-title">'+e.name+"</p>",t+=gmb.add_place_content_to_info_window(e),t=gmb.set_info_window_wrapper(t),info_bubble.setContent(t),gmg.initialize_tooltips()}else info_bubble.setContent('<p class="place-error">Google API Error: '+a+"</p>")})},gmb.get_places_type_array=function(){var e=[];return $('.cmb2-id-gmb-places-search-multicheckbox input[type="checkbox"]').each(function(){$(this).is(":checked")&&e.push($(this).val())}),e},gmb.perform_places_search=function(){$(".places-loading").fadeIn(),$(".warning-message").hide().empty();var e=gmb.get_places_type_array();if(gmb.clear_search_markers(),e.length>0){var a={key:gmb_data.api_key,location:gmb.return_lat_lng(),types:e,radius:parseInt($("#gmb_search_radius").val())};places_service.nearbySearch(a,gmb.places_search_callback)}else gmb.show_warning_message("<strong>Notice: No Place Types are selected</strong><br/> Please select the types of places you would like to display on this map using the Place Type field checkboxes found below.")},gmb.show_warning_message=function(e){$(".wpgp-loading").fadeOut(),$(".warning-message").empty().append("<p>"+e+"</p>").fadeIn()},gmb.return_lat_lng=function(){var e=map.getCenter(),a=new google.maps.LatLng(e.lat(),e.lng());return a},gmb.handle_map_zoom=function(e){var a=e.getZoom();$("#gmb_zoom").val(a),$("#gmb_zoom").on("change",function(){e.setZoom(parseInt($(this).val()))})},gmb.lat_lng_field_change=function(e){var a=new google.maps.LatLng($(lat_field).val(),$(lng_field).val());e.panTo(a)},gmb.places_search_callback=function(e,a,t){var o,i=0;if(a==google.maps.places.PlacesServiceStatus.OK){for(i=0;o=e[i];i++)gmb.create_search_result_marker(e[i]);t.hasNextPage?t.nextPage():$(".places-loading").fadeOut()}},gmb.create_search_result_marker=function(e){var a=new Marker({map:map,zIndex:0,optimized:!1});a.setIcon({url:e.icon,size:new google.maps.Size(24,24),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(24,24)}),a.setPosition(e.geometry.location),a.setVisible(!0),google.maps.event.addListener(a,"click",function(){gmb.get_place_info_window_content(e,a)}),search_markers.push(a)},gmb.clear_main_markers=function(){for(var e=0;e<location_marker_array.length;e++)location_marker_array[e].setMap(null);for(location_marker_array.length=0,e=0;e<info_bubble_array.length;e++)info_bubble_array[e].close(),google.maps.event.trigger(info_bubble_array[e],"closeclick");info_bubble_array.length=0},gmb.toggle_marker_animation=function(){gmb.clear_main_markers()},gmb.clear_search_markers=function(){for(var e=0;e<search_markers.length;e++)search_markers[e].setMap(null);search_markers=[]},gmb.geocode_position=function(e){var a={key:gmb_data.api_key,location:e,radius:10};places_service.nearbySearch(a,function(e,a){if(a==google.maps.places.PlacesServiceStatus.OK){var t="";if(info_bubble.close(),e.length>1){t='<div id="infobubble-content"><p>'+gmb_data.i18n.multiple_places+"</p>";for(var o=0;o<e.length;o++)t+='<a class="marker-confirm-place"  data-place_id="'+e[o].place_id+'" data-name-address="'+e[o].name+", "+e[o].vicinity+'">'+e[o].name+"</a>";t+="</div>",google.maps.event.addDomListener(info_bubble,"domready",function(){$(".marker-confirm-place").on("click",function(e){e.preventDefault(),$("#gmb_geocoder").val($(this).data("name-address")),$("#gmb_place_id").val($(this).data("place_id")),info_bubble.close(),gmb.get_info_window_content($(this).data("place_id"))})})}info_bubble.setContent(t),info_bubble.open(map,location_marker)}})},gmb.scroll_to_field=function(e){$("html, body").animate({scrollTop:parseInt($(e).offset().top)},600)},gmb.marker_drag_end=function(e){var a=e.getPosition();gmb.geocode_position(a),$(lat_field).val(a.lat()),$(lng_field).val(a.lng()),map.panTo(a)},gmb.calc_radius=function(e,a){radius_marker=new Marker({position:e.getCenter(),map:e,icon:{path:MAP_PIN,fillColor:"#0E77E9",fillOpacity:0,strokeColor:"",strokeWeight:0,scale:.25},custom_label:'<i class="map-icon-crosshairs radius-label"></i>',zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1}),radius_circle=new google.maps.Circle({map:e,fillColor:"#BBD8E9",fillOpacity:.3,radius:a,strokeColor:"#BBD8E9",strokeOpacity:.9,strokeWeight:2}),radius_circle.bindTo("center",radius_marker,"position")},gmb.toggle_metabox_fields=function(){var e=$(".cmb2-id-gmb-show-places input:radio");e.prop("checked")&&$(".cmb2-id-gmb-search-radius, .cmb2-id-gmb-places-search-multicheckbox, .cmb2-id-gmb-places-search").toggle(),e.prop("checked")||$("#gmb_show_places2").prop("checked",!0),$(".cmb2-id-gmb-show-places li input:radio").on("click",function(){$(this).find("input:radio").prop("checked",!0),"no"===$(this).val()?(gmb.clear_search_markers(),$(".cmb2-id-gmb-search-radius, .cmb2-id-gmb-places-search-multicheckbox, .cmb2-id-gmb-places-search").hide()):(gmb.perform_places_search(),$(".cmb2-id-gmb-search-radius, .cmb2-id-gmb-places-search-multicheckbox, .cmb2-id-gmb-places-search").show())})},gmb.set_map_zoom_control=function(){var e=$("#gmb_zoom_control").val().toLowerCase();"none"==e?map.setOptions({zoomControl:!1}):map.setOptions({zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle[e]}})},gmb.set_map_type_control=function(){var e=$("#gmb_map_type_control").val().toLowerCase();"none"==e?map.setOptions({mapTypeControl:!1}):map.setOptions({mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle[e]}})},gmb.set_mouse_wheel_scroll=function(){var e=$("#gmb_wheel_zoom").val();"none"===e?map.setOptions({scrollwheel:!1}):map.setOptions({scrollwheel:!0})},gmb.set_double_click_zoom=function(){var e=$("#gmb_double_click").val();"none"===e?map.setOptions({disableDoubleClickZoom:!0}):map.setOptions({disableDoubleClickZoom:!1})},gmb.set_draggable=function(){var e=$("#gmb_draggable").val();"none"==e?map.setOptions({draggable:!1}):map.setOptions({draggable:!0})},gmb.set_pan_control=function(){var e=$("#gmb_pan").val();"none"===e?map.setOptions({panControl:!1}):map.setOptions({panControl:!0})},gmb.set_street_view=function(){var e=$("#gmb_street_view").val();"none"===e?map.setOptions({streetViewControl:!1}):map.setOptions({streetViewControl:!0})},gmb.set_map_type=function(e){e===!0&&($("#gmb_theme").val("none"),$("#gmb_theme_json").val(" "));var a=$("#gmb_type").val().toUpperCase();map.setOptions({mapTypeId:google.maps.MapTypeId[a],styles:!1})},gmb.set_map_marker_icon=function(){var e=$(".marker-icon-row"),a=$(".marker-icon-modal"),t=a.find(".save-marker-icon"),o=a.find(".save-marker-button");$(".marker-item").on("click",function(){var a=$(this).data("marker"),t=$(this).data("toggle");$(".marker-item").removeClass("marker-item-selected"),$(this).addClass("marker-item-selected"),o.attr("data-marker",a),e.hide(),$("."+t).show()}),$(".maps-icon").on("click",function(){$(".maps-icon").removeClass("marker-item-selected"),t.slideDown(),$(this).addClass("marker-item-selected"),o.data("marker-image",$(this).find("img").attr("src"))}),$(".icon").on("click",function(){$(".icon").removeClass("marker-item-selected"),$(this).addClass("marker-item-selected"),$(".save-marker-icon, .marker-label-color-wrap").show(),o.attr("data-label",$(this).find("span").attr("class"))});var i={change:function(e,a){var t=a.color.toString();$(this).hasClass("marker-color")===!0?($(".save-marker-button").attr("data-marker-color",t),$(".marker-svg polygon, .marker-svg path").attr("fill",t)):$(this).hasClass("label-color")===!0&&($(".save-marker-button").attr("data-label-color",t),$(".icon-inner span").css("color",t))},clear:function(){},hide:!0,palettes:!0};$(".color-picker").wpColorPicker(i)},gmb.set_marker_edit_icons=function(e){return'<div class="infowindow-toolbar"><ul id="edit-toolbar"><li class="edit-info" data-index="'+e+'" data-tooltip="'+gmb_data.i18n.btn_edit_marker+'"></li><li class="trash-marker" data-index="'+e+'" data-tooltip="'+gmb_data.i18n.btn_delete_marker+'"></li></ul></div>'},gmb.initialize_tooltips=function(){$('[data-tooltip!=""]').qtip({content:{attr:"data-tooltip"},hide:{fixed:!0,delay:100},position:{my:"top center",at:"bottom center"},style:{classes:"qtip-tipsy"},show:{when:{event:"focus"},effect:function(){$(this).fadeIn(200)}}})},gmb.set_map_theme=function(){}}(jQuery,window.MapsBuilderAdmin||(window.MapsBuilderAdmin={})),jQuery(window).load(function(){MapsBuilderAdmin.init();var e=new CustomEvent("MapBuilderAdminInit");window.dispatchEvent(e)});