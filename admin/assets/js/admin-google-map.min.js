!function($){"use strict";function drop_marker(a,b){var c=a.lat(),d=a.lng();"undefined"!=typeof e&&e.setVisible(!1),$(".drop-marker").removeClass("active").text("Drop a Marker"),map.setOptions({draggableCursor:null}),google.maps.event.removeListener(b);var e=new Marker({position:a,map:map,icon:gmb_data.plugin_url+"/public/assets/img/default-marker.png",zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1}),f=get_marker_index();$("#gmb_markers_group_"+f+"_title").val("Point "+f),$("#gmb_markers_group_"+f+"_lat").val(c),$("#gmb_markers_group_"+f+"_lng").val(d),get_editable_info_window(f,e),google.maps.event.addListener(e,"click",function(){get_info_window_content(f,e)})}function initialize_map(a){lat_field=$("#gmb_lat_lng-latitude"),lng_field=$("#gmb_lat_lng-longitude");var b=lat_field.val()?lat_field.val():"",c=lng_field.val()?lng_field.val():"";zoom=parseInt($("#gmb_zoom").val()),lat_lng=new google.maps.LatLng(b,c);var d={zoom:zoom,streetViewControl:!1,styles:[{stylers:[{visibility:"simplified"}]},{elementType:"labels",stylers:[{visibility:"off"}]}]};map=new google.maps.Map(a[0],d),places_service=new google.maps.places.PlacesService(map),navigator.geolocation&&"yes"===gmb_data.geolocate_setting&&""==c&&""==b?navigator.geolocation.getCurrentPosition(function(a){initial_location=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),map.setCenter(initial_location),lat_field.val(a.coords.latitude),lng_field.val(a.coords.longitude)}):""!==b&&""!==c?map.setCenter(new google.maps.LatLng(b,c)):(alert("Geolocation service failed."),initial_location=new google.maps.LatLng(gmb_data.default_lat,gmb_data.default_lng),lat_field.val(gmb_data.default_lat),lng_field.val(gmb_data.default_lng),map.setCenter(initial_location)),set_map_type(!1),"none"!==$("#gmb_theme").val()&&set_map_theme(!1),set_street_view(),set_pan_control(),set_draggable(),set_double_click_zoom(),set_mouse_wheel_scroll(),set_map_type_control(),set_map_zoom_control(),"undefined"==typeof autocomplete&&(autocomplete=new google.maps.places.Autocomplete($("#gmb_geocoder")[0]),autocomplete.bindTo("bounds",map),google.maps.event.addListener(autocomplete,"place_changed",function(){return $("#gmb_geocoder").one("blur",function(){$("#gmb_geocoder").val("")}),setTimeout(function(){$("#gmb_geocoder").val("")},10),"undefined"!=typeof tentative_location_marker&&tentative_location_marker.setVisible(!1),place=autocomplete.getPlace(),lat_field.val(place.geometry.location.lat()),lng_field.val(place.geometry.location.lng()),place.geometry?(map.setCenter(place.geometry.location),void add_tentative_marker(map,place.reference)):void alert("Error: Place not found!")})),info_bubble=new google.maps.InfoWindow({maxWidth:315}),google.maps.event.addListenerOnce(map,"idle",function(){handle_map_zoom(map),add_markers(map),"undefined"!=typeof $(".cmb_id_gmb_show_places input:radio").prop("checked")&&"yes"===$(".cmb_id_gmb_show_places input:radio:checked").val()&&perform_places_search()}),google.maps.event.addListener(map,"zoom_changed",function(){handle_map_zoom(map)}),google.maps.event.addListener(map,"dragend",function(){var a=map.getCenter();$(".lat-lng-change-message").slideDown(),$(".lat-lng-update-btn").attr("data-lat",a.lat()),$(".lat-lng-update-btn").attr("data-lng",a.lng())})}function add_tentative_marker(a,b){var c=a.getCenter();tentative_location_marker=new google.maps.Marker({map:a,title:"Map Icons",animation:google.maps.Animation.DROP,position:new google.maps.LatLng(c.lat(),c.lng()),icon:new google.maps.MarkerImage(gmb_data.plugin_url+"/public/assets/img/temp-marker.png"),zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1});var d=google.maps.event.addListener(tentative_location_marker,"mouseover",function(){add_circle(b)}),e=google.maps.event.addListener(tentative_location_marker,"mouseout",function(){hover_circle.setVisible(!1)});google.maps.event.addListener(tentative_location_marker,"click",function(){google.maps.event.removeListener(d),google.maps.event.removeListener(e),hover_circle.setVisible(!0),add_tenative_info_window(b,tentative_location_marker)}),tentative_location_marker.setVisible(!0),a.setZoom(zoom)}function add_tenative_info_window(a,b){var c={key:gmb_data.api_key,reference:a};places_service.getDetails(c,function(a,c){if(c==google.maps.places.PlacesServiceStatus.OK){var d=a.geometry.location.lat(),e=a.geometry.location.lng(),f='<p class="place-title">'+a.name+"</p>";f+=add_place_content_to_info_window(a),f+='<div class="infowindow-toolbar clear"><a href="#" class="add-marker" data-title="'+a.name+'" data-reference="'+a.reference+'"  data-lat="'+d+'" data-lng="'+e+'">Add to Map</a></div>',f=set_info_window_wrapper(f),info_bubble.setContent(f),info_bubble.open(map,b),google.maps.event.addListener(info_bubble,"closeclick",function(){hover_circle.setVisible(!1)})}})}function add_place_content_to_info_window(a){var b;return b='<div class="marker-info-wrapper">',b+=a.formatted_address?'<div class="place-address">'+a.formatted_address+"</div>":"",b+=a.formatted_phone_number?'<div class="place-phone">'+a.formatted_phone_number+"</div>":"",b+=a.website?'<div class="place-website"><a href="'+a.website+'" target="_blank" rel="nofollow" title="Click to visit the '+a.name+' website">Website</a></div>':"",a.rating&&(b+='<div class="rating-wrap clear"><p class="numeric-rating">'+a.rating+'</p><div class="star-rating-wrap"><div class="star-rating-size" style="width:'+65*a.rating/5+'px;"></div></div></div>'),b+="</div>"}function get_editable_info_window(index,marker){info_bubble.close(),info_bubble.setContent('<div id="infobubble-content" class="loading"></div>'),info_bubble.open(map,marker);var info_window_data=get_info_window_saved_data(index),info_window_content;info_window_data.title||(info_window_data.title="Point "+index),info_window_content='<input class="edit-place-title" data-field="#gmb_markers_group_'+index+'_title" type="text" value="'+info_window_data.title+'">',info_window_content+='<textarea class="edit-place-description" data-field="#gmb_markers_group_'+index+'_description">'+info_window_data.desc+"</textarea>",info_window_content+='<div class="infowindow-toolbar clear"><ul id="save-toolbar"><li class="info-window-save"><div class="google-btn-blue google-btn google-save-btn" data-tooltip="Save changes" data-index="'+index+'">Save</div></li><li class="info-window-cancel"><div class="google-btn-default google-btn google-cancel-btn" data-tooltip="Cancel edit" data-index="'+index+'">Cancel</div></li></ul><span class="marker-edit-link-wrap" data-index="'+index+'"><a href="#TB_inline?width=600&height=550&inlineId=marker-icon-modal" data-tooltip="Change icon" class="marker-edit-link thickbox"></a></span></div>',info_window_content=set_info_window_wrapper(info_window_content),info_bubble.setContent(info_window_content),initialize_tooltips(),google.maps.event.addDomListener($(".google-save-btn")[0],"click",function(){var a=$(".edit-place-title").data("field"),b=$(".edit-place-title").val(),c=$(".edit-place-description").data("field"),d=$(".edit-place-description").val();$(a).val(b),$(c).val(d),get_info_window_content($(this).data("index"),marker),google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)}),google.maps.event.addDomListener(info_bubble,"closeclick",function(){google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)}),google.maps.event.addDomListener($(".google-cancel-btn")[0],"click",function(){get_info_window_content($(this).data("index"),marker),google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)});var edit_marker_icon_button_click=google.maps.event.addDomListener($(".marker-edit-link-wrap")[0],"click",function(){$(".save-marker-button").attr("data-marker-index",$(this).data("index"))}),save_icon_listener=google.maps.event.addDomListener($(".save-marker-button")[0],"click",function(){var marker_position=marker.getPosition(),marker_icon_data,marker_icon=$(this).data("marker"),marker_icon_color=$(this).data("marker-color"),label_color=$(this).data("label-color"),marker_label_inline_style="color:"+label_color+"; ";"MAP_PIN"===marker_icon?marker_label_inline_style+="font-size: 20px;position: relative; top: -3px;":"SQUARE_PIN"==marker_icon&&(marker_label_inline_style+="font-size: 20px;position: relative; top: 12px;");var marker_label_data='<i class="'+$(this).data("label")+'" style="'+marker_label_inline_style+'"></i>';""==marker_icon?(marker_icon_data=gmb_data.plugin_url+"/public/assets/img/default-marker.png",$("#gmb_markers_group_"+index+"_marker").val(""),marker_label_data=""):(marker_icon_data="{ path : "+marker_icon+', fillColor : "'+marker_icon_color+'", fillOpacity : 1, strokeColor : "", strokeWeight: 0, scale : 1 / 3 }',$("#gmb_markers_group_"+index+"_marker").val(marker_icon_data),marker_icon_data=eval("("+marker_icon_data+")")),marker.setMap(null),$("#gmb_markers_group_"+index+"_label").val(marker_label_data),marker=new Marker({position:marker_position,map:map,zIndex:9,icon:marker_icon_data,label:marker_label_data}),google.maps.event.addListener(marker,"click",function(){get_info_window_content(index,marker)}),$(".icon, .marker-item").removeClass("marker-item-selected"),$(".marker-icon-row, .save-marker-icon, .marker-icon-color-wrap, .marker-label-color-wrap").hide(),$(this).removeData("marker"),$(this).removeData("marker-color"),$(this).removeData("label"),$(this).removeData("label-color"),tb_remove(),google.maps.event.removeListener(save_icon_listener),google.maps.event.removeListener(edit_marker_icon_button_click)})}function set_info_window_wrapper(a){var b='<div id="infobubble-content" class="main-place-infobubble-content">';return b+=a,b+="</div>"}function add_circle(a){hover_circle=new google.maps.Marker({position:tentative_location_marker.getPosition(),zIndex:google.maps.Marker.MAX_ZINDEX-1,optimized:!1,icon:{path:google.maps.SymbolPath.CIRCLE,scale:20,strokeWeight:3,strokeOpacity:.9,strokeColor:"#FFF",fillOpacity:.3,fillColor:"#FFF"},map:map}),google.maps.event.addListener(hover_circle,"click",function(){add_tenative_info_window(a,tentative_location_marker)}),google.maps.event.addListener(tentative_location_marker,"click",function(){hover_circle.setVisible(!0)})}function add_markers(map){clear_main_markers(),$("#gmb_markers_group_repeat .repeatable-grouping").each(function(index){var marker_icon=gmb_data.plugin_url+"/public/assets/img/default-marker.png",marker_label="",custom_marker_icon=$("#gmb_markers_group_"+index+"_marker").val();custom_marker_icon.length>0&&(marker_icon=eval("("+custom_marker_icon+")"));var custom_label=$("#gmb_markers_group_"+index+"_label").val();custom_label.length>0&&(marker_label=custom_label);var location_marker=new Marker({map:map,zIndex:9,icon:marker_icon,label:marker_label}),marker_lat=$("#gmb_markers_group_"+index+"_lat").val(),marker_lng=$("#gmb_markers_group_"+index+"_lng").val();location_marker.setPosition(new google.maps.LatLng(marker_lat,marker_lng)),location_marker.setVisible(!0),google.maps.event.addListener(location_marker,"click",function(){get_info_window_content(index,location_marker)})})}function get_info_window_saved_data(a){var b=new Object;return b.title=$("#gmb_markers_group_"+a+"_title").val(),b.desc=$("#gmb_markers_group_"+a+"_description").val(),b.reference=$("#gmb_markers_group_"+a+"_reference").val(),b.lat=$("#gmb_markers_group_"+a+"_lat").val(),b.lng=$("#gmb_markers_group_"+a+"_lng").val(),b}function get_info_window_content(a,b){info_bubble.close(),info_bubble.setContent('<div id="infobubble-content" class="loading"></div>'),info_bubble.open(map,b);var c,d=get_info_window_saved_data(a);if(d.reference){var e={reference:d.reference};places_service.getDetails(e,function(e,f){f==google.maps.places.PlacesServiceStatus.OK&&(c='<p class="place-title">'+d.title+"</p>",c+='<div class="place-description">'+d.desc+"</div>",c+=add_place_content_to_info_window(e),c+='<div class="infowindow-toolbar"><ul id="edit-toolbar"><li class="edit-info" data-index="'+a+'" data-tooltip="Edit Marker"></li><li class="trash-marker" data-index="'+a+'" data-tooltip="Delete Marker"></li></ul></div>',add_edit_events(c,b))})}else c='<p class="place-title">'+d.title+"</p>",c+='<div class="place-description">'+d.desc+"</div>",c+='<div class="infowindow-toolbar"><ul id="edit-toolbar"><li class="edit-info" data-index="'+a+'" data-tooltip="Edit Marker"></li><li class="trash-marker" data-index="'+a+'" data-tooltip="Delete Marker"></li></ul></div>',add_edit_events(c,b)}function add_edit_events(a,b){a=set_info_window_wrapper(a),info_bubble.setContent(a),initialize_tooltips(),google.maps.event.addDomListener($(".edit-info")[0],"click",function(){get_editable_info_window($(this).data("index"),b)}),google.maps.event.addDomListener($(".trash-marker")[0],"click",function(){var a=$(this).data("index");0===a&&$('tr[data-iterator="'+a+'"] ').find("input,textarea").val(""),$('tr[data-iterator="'+a+'"] .remove-group-row').trigger("click"),info_bubble.close(),b.setVisible(!1)})}function get_marker_index(){var a=parseInt($("#gmb_markers_group_repeat tr.repeatable-grouping").last().attr("data-iterator")),b=$('tr[data-iterator="0"] ').find("input,textarea").val();return b&&0===a?($(".add-group-row.button").trigger("click"),a=1):0!==a&&($(".add-group-row.button").trigger("click"),a=parseInt($("#gmb_markers_group_repeat tr.repeatable-grouping").last().attr("data-iterator"))),a}function get_place_info_window_content(a,b){info_bubble.setContent('<div id="infobubble-content" class="loading"></div>'),info_bubble.open(map,b);var c={reference:a.reference};places_service.getDetails(c,function(a,b){if(b==google.maps.places.PlacesServiceStatus.OK){var c;c='<p class="place-title">'+a.name+"</p>",c+=add_place_content_to_info_window(a),c=set_info_window_wrapper(c),info_bubble.setContent(c),initialize_tooltips()}})}function get_places_type_array(){var a=[];return $('.cmb_id_gmb_places_search_multicheckbox input[type="checkbox"]').each(function(){$(this).is(":checked")&&a.push($(this).val())}),a}function perform_places_search(){$(".places-loading").fadeIn(),$(".warning-message").hide().empty();var a=get_places_type_array();if(clear_search_markers(),a.length>0){var b={location:return_lat_lng(),types:a,radius:parseInt($("#gmb_search_radius").val())};places_service.nearbySearch(b,places_search_callback)}else show_warning_message("<strong>Notice: No Place Types are selected</strong><br/> Please select the types of places you would like to display on this map using the Place Type field checkboxes found below.")}function show_warning_message(a){$(".wpgp-loading").fadeOut(),$(".warning-message").empty().append("<p>"+a+"</p>").fadeIn()}function return_lat_lng(){var a=map.getCenter(),b=new google.maps.LatLng(a.lat(),a.lng());return b}function handle_map_zoom(a){var b=a.getZoom();$("#gmb_zoom").val(b),$("#gmb_zoom").on("change",function(){a.setZoom(parseInt($(this).val()))})}function lat_lng_field_change(a){var b=new google.maps.LatLng($(lat_field).val(),$(lng_field).val());a.panTo(b)}function places_search_callback(a,b,c){var d,e=0;if(b==google.maps.places.PlacesServiceStatus.OK){for(e=0;d=a[e];e++)create_search_result_marker(a[e]);c.hasNextPage?c.nextPage():$(".places-loading").fadeOut()}}function create_search_result_marker(a){var b=new Marker({map:map,zIndex:0,optimized:!1});b.setIcon({url:a.icon,size:new google.maps.Size(24,24),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(24,24)}),b.setPosition(a.geometry.location),b.setVisible(!0),google.maps.event.addListener(b,"click",function(){get_place_info_window_content(a,b)}),search_markers.push(b)}function clear_main_markers(){for(var a=0;a<location_marker_array.length;a++)location_marker_array[a].setMap(null);for(location_marker_array.length=0,a=0;a<info_bubble_array.length;a++)info_bubble_array[a].close(),google.maps.event.trigger(info_bubble_array[a],"closeclick");info_bubble_array.length=0}function clear_search_markers(){for(var a=0;a<search_markers.length;a++)search_markers[a].setMap(null);search_markers=[]}function geocode_position(a){var b={location:a,radius:10};places_service.nearbySearch(b,function(a,b){if(b==google.maps.places.PlacesServiceStatus.OK){var c="";if(info_bubble.close(),a.length>1){c='<div id="infobubble-content"><p>Hmm, it looks like there are multiple places in this area. Please confirm which place you would like this marker to display:</p>';for(var d=0;d<a.length;d++)c+='<a class="marker-confirm-place"  data-reference="'+a[d].reference+'" data-name-address="'+a[d].name+", "+a[d].vicinity+'">'+a[d].name+"</a>";c+="</div>",google.maps.event.addDomListener(info_bubble,"domready",function(){$(".marker-confirm-place").on("click",function(a){a.preventDefault(),$("#gmb_geocoder").val($(this).data("name-address")),$("#gmb_reference").val($(this).data("reference")),info_bubble.close(),get_info_window_content($(this).data("reference"))})})}info_bubble.setContent(c),info_bubble.open(map,location_marker)}})}function scroll_to_field(a){$("html, body").animate({scrollTop:parseInt($(a).offset().top)},600)}function marker_drag_end(a){var b=a.getPosition();geocode_position(b),$(lat_field).val(b.lat()),$(lng_field).val(b.lng()),map.panTo(b)}function calc_radius(a,b){radius_marker=new Marker({position:a.getCenter(),map:a,icon:{path:MAP_PIN,fillColor:"#0E77E9",fillOpacity:0,strokeColor:"",strokeWeight:0,scale:.25},label:'<i class="map-icon-crosshairs radius-label"></i>',zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1}),radius_circle=new google.maps.Circle({map:a,fillColor:"#BBD8E9",fillOpacity:.3,radius:b,strokeColor:"#BBD8E9",strokeOpacity:.9,strokeWeight:2}),radius_circle.bindTo("center",radius_marker,"position")}function toggle_metabox_fields(){var a=$(".cmb_id_gmb_show_places input:radio");a.prop("checked")===!0&&($(".cmb_id_gmb_search_radius").show(),$(".cmb_id_gmb_places_search_multicheckbox").show()),a.prop("checked")===!1&&$("#gmb_show_places2").prop("checked",!0),a.on("change",function(){$(".cmb_id_gmb_search_radius").toggle(),$(".cmb_id_gmb_places_search_multicheckbox").toggle(),"no"===$(this).val()?clear_search_markers():perform_places_search()})}function set_map_size(){var a=$("#gmb_width_height-width").val(),b=$('input[name="gmb_width_height[map_width_unit]"]:checked').val(),c=$("#gmb_width_height-height").val();$("#map").css({width:a+b,height:c})}function set_map_zoom_control(){var a=$("#gmb_zoom_control").val().toUpperCase();map.setOptions("NONE"==a?{zoomControl:!1}:{zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle[a]}})}function set_map_type_control(){var a=$("#gmb_map_type_control").val().toUpperCase();map.setOptions("NONE"==a?{mapTypeControl:!1}:{mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle[a]}})}function set_mouse_wheel_scroll(){var a=$("#gmb_wheel_zoom").val();map.setOptions("none"===a?{scrollwheel:!1}:{scrollwheel:!0})}function set_double_click_zoom(){var a=$("#gmb_double_click").val();map.setOptions("none"===a?{disableDoubleClickZoom:!0}:{disableDoubleClickZoom:!1})}function set_draggable(){var a=$("#gmb_draggable").val();map.setOptions("none"==a?{draggable:!1}:{draggable:!0})}function set_pan_control(){var a=$("#gmb_pan").val();map.setOptions("none"===a?{panControl:!1}:{panControl:!0})}function set_street_view(){var a=$("#gmb_street_view").val();map.setOptions("none"===a?{streetViewControl:!1}:{streetViewControl:!0})}function set_map_type(a){a===!0&&($("#gmb_theme").val("none"),$("#gmb_theme_json").val("none"));var b=$("#gmb_type").val().toUpperCase();map.setOptions({mapTypeId:google.maps.MapTypeId[b],styles:!1})}function set_map_theme(reset){reset===!0&&($("#gmb_type").val("RoadMap"),$("#gmb_theme_json").val("none")),$.getJSON(gmb_data.snazzy,function(data){var map_theme_input_val=parseInt($("#gmb_theme").val());"none"===map_theme_input_val&&set_map_type(),$.each(data,function(index){data[index].id===map_theme_input_val&&(map_theme_input_val=eval(data[index].json),$("#gmb_theme_json").val(data[index].json))}),map.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP,styles:map_theme_input_val})})}function set_map_marker_icon(){$(".marker-item").on("click",function(){var a=$(this).data("marker");$(".marker-item").removeClass("marker-item-selected"),$(this).addClass("marker-item-selected"),"default"==a?($(".marker-icon-row, .marker-icon-color-wrap, .marker-label-color-wrap").slideUp(),$(".save-marker-icon").slideDown(),$("#TB_window .save-marker-button").attr("data-marker",""),$("#TB_window .save-marker-button").attr("data-label","")):($(".marker-icon-color-wrap, .marker-icon-row").slideDown(),$("#TB_window .save-marker-button").attr("data-marker",a))}),$(".icon").on("click",function(){$(".icon").removeClass("marker-item-selected"),$(this).addClass("marker-item-selected"),$(".save-marker-icon, .marker-label-color-wrap").slideDown(),$("#TB_window .save-marker-button").attr("data-label",$(this).find("span").attr("class"))});var a={change:function(a,b){var c=b.color.toString();$(this).hasClass("marker-color")===!0?($(".save-marker-button").attr("data-marker-color",c),$(".marker-svg polygon, .marker-svg path").attr("fill",c)):$(this).hasClass("label-color")===!0&&($(".save-marker-button").attr("data-label-color",c),$(".icon-inner span").css("color",c))},clear:function(){},hide:!0,palettes:!0};$(".color-picker").wpColorPicker(a)}function initialize_tooltips(){$('[data-tooltip!=""]').qtip({content:{attr:"data-tooltip"},hide:{fixed:!0,delay:100},position:{my:"top center",at:"bottom center"},style:{classes:"qtip-tipsy"},show:{when:{event:"focus"},effect:function(){$(this).fadeIn(200)}}})}$(window).load(function(){toggle_metabox_fields(),initialize_tooltips(),initialize_map($("#map")),$("#gmb_lat_lng-latitude").on("change",function(){lat_lng_field_change(map)}),$("#gmb_lat_lng-longitude").on("change",function(){lat_lng_field_change(map)}),$(".drop-marker").on("click",function(a){if(a.preventDefault(),$(this).hasClass("active"))$(this).text("Drop a Marker").removeClass("active"),map.setOptions({draggableCursor:null});else{$(this).text("Click on the Map").addClass("active"),map.setOptions({draggableCursor:"crosshair"});var b=google.maps.event.addListener(map,"click",function(a){drop_marker(a.latLng,b)})}});var a;$("#gmb_search_radius").on("focus",function(){a=$(this).val(),calc_radius(map,parseInt($(this).val()))}).focusout(function(){a!==$(this).val()&&perform_places_search(),radius_circle.setMap(null),radius_marker.setMap(null)}),$('[name^="gmb_places_search_multicheckbox"]').on("change",function(){0===$(".places-change-message").length&&($(".cmb_id_gmb_places_search_multicheckbox ul").prepend('<div class="wpgp-message places-change-message clear"><p>Place selections have changed.</p><a href="#" class="button update-places-map">Update Map</a></div>'),$(".places-change-message").slideDown())}),$(document).on("click",".update-places-map",function(a){a.preventDefault(),scroll_to_field("#google_maps_preview_metabox"),perform_places_search(),$(this).parent().fadeOut(function(){$(this).remove()})}),$(".lat-lng-update-btn").on("click",function(a){a.preventDefault(),$(".lat-lng-change-message").slideUp(),$("#gmb_lat_lng-latitude").val($(this).attr("data-lat")),$("#gmb_lat_lng-longitude").val($(this).attr("data-lng"))}),$(document).on("click",".add-marker",function(a){a.preventDefault(),hover_circle.setVisible(!1);var b=new google.maps.Marker({position:tentative_location_marker.getPosition(),map:map,icon:gmb_data.plugin_url+"/public/assets/img/default-marker.png",zIndex:google.maps.Marker.MAX_ZINDEX+1,optimized:!1});tentative_location_marker.setVisible(!1);var c=get_marker_index(),d=$(this).data("reference");$("#gmb_markers_group_"+c+"_title").val($(this).data("title")),$("#gmb_markers_group_"+c+"_lat").val($(this).data("lat")),$("#gmb_markers_group_"+c+"_lng").val($(this).data("lng")),$("#gmb_markers_group_"+c+"_reference").val(d),get_editable_info_window(c,b),google.maps.event.addListener(b,"click",function(){get_info_window_content(c,b)})}),set_map_marker_icon(),$("#gmb_type").change(function(){set_map_type(!0)}),$("#gmb_theme").change(function(){set_map_theme(!0)}),$("#gmb_street_view").change(function(){set_street_view()}),$("#gmb_pan").change(function(){set_pan_control()}),$("#gmb_draggable").change(function(){set_draggable()}),$("#gmb_double_click").change(function(){set_double_click_zoom()}),$("#gmb_wheel_zoom").change(function(){set_mouse_wheel_scroll()}),$("#gmb_map_type_control").change(function(){set_map_type_control()}),$("#gmb_zoom_control").change(function(){set_map_zoom_control()}),$("#gmb_width_height-width, #gmb_width_height-height").keyup(function(){delay(function(){set_map_size()},500)}),$('input[name="gmb_width_height[map_width_unit]"]').change(function(){set_map_size()})});var map,places_service,lat_lng,zoom,lat_field,lng_field,radius_circle,radius_marker,place,autocomplete,info_bubble,info_bubble_array=[],tentative_location_marker,location_marker,location_marker_array=[],search_markers=[],hover_circle,initial_location,delay=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}()}(jQuery);